humhub.module("calendar.recurrence.Form",function(t,e,c){var r=e("ui.widget").Widget,n=e("client"),r=r.extend(),i="#recurrenceformmodel-frequency";r.prototype.init=function(){this.updatedValue(),this.updatedType(),this.updatedEnd();var r=this;this.options.pickerSelector&&c(this.options.pickerSelector).on("change",function(){var e=c(this),t=e.datepicker("getDate");c("#recurrenceformmodel-weekdays").val(t.getDay()+1).trigger("change"),r.updateMonthlySelection(e.val())})},r.prototype.updateMonthlySelection=function(e){n.get(this.options.updateMonthlyRecurrenceTest,{data:{date:e}}).then(function(t){var n;t.result&&(n=c("#recurrenceformmodel-monthdayselection"),c.each(t.result,function(e,t){var r=n.find("option[value="+e+"]");r.length?r.text(t):n.append(c("<option>").attr("value",e).text(t))}),n.find("option").each(function(){var e=c(this).val();t.result[e]||c(this).remove()}))}).catch(function(e){t.log.error(e)})},r.prototype.updatedValue=function(){var e=this.$.find(i),r=parseInt(this.$.find("#recurrenceformmodel-interval").val(),10);e.find("option").each(function(){var e=c(this),t=1<r?e.data("plural"):e.data("singular");e.text(t)})},r.prototype.updatedType=function(){var e=parseInt(this.$.find(i).val(),10);-1===e?this.$.find(".hideIfNoRecurrence").hide():(this.$.find(".hideIfNoRecurrence").show(),this.$.find("[data-recurrence-type]").hide(),this.$.find('[data-recurrence-type="'+e+'"]').show())},r.prototype.updatedEnd=function(){switch(parseInt(this.$.find("#recurrenceformmodel-end").val(),10)){case 0:return void c(".recurrence-end-date, .recurrence-end-occurrences").hide();case 1:return c(".recurrence-end-date").show(),void c(".recurrence-end-occurrences").hide();case 2:return c(".recurrence-end-date").hide(),void c(".recurrence-end-occurrences").show()}},t.export=r});