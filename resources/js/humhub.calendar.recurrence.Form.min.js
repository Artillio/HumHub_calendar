humhub.module("calendar.recurrence.Form",function(t,e,r){var n=e("ui.widget").Widget,o=e("client"),c=n.extend(),i="#recurrenceformmodel-frequency";c.prototype.init=function(){this.updatedValue(),this.updatedType(),this.updatedEnd();var n=this;this.options.pickerSelector&&r(this.options.pickerSelector).on("change",function(){var e=r(this),t=e.datepicker("getDate");r("#recurrenceformmodel-weekdays").val(t.getDay()+1).trigger("change"),n.updateMonthlySelection(e.val())})},c.prototype.updateMonthlySelection=function(e){o.get(this.options.updateMonthlyRecurrenceTest,{data:{date:e}}).then(function(t){t.result&&($monthlySelection=r("#recurrenceformmodel-monthdayselection"),r.each(t.result,function(e,t){var n=$monthlySelection.find("option[value="+e+"]");n.length?n.text(t):$monthlySelection.append(r("<option>").attr("value",e).text(t))}),$monthlySelection.find("option").each(function(){var e=r(this).val();t.result[e]||r(this).remove()}))}).catch(function(e){t.log.error(e)})},c.prototype.updatedValue=function(){var e=this.$.find(i),n=parseInt(this.$.find("#recurrenceformmodel-interval").val(),10);e.find("option").each(function(){var e=r(this),t=1<n?e.data("plural"):e.data("singular");e.text(t)})},c.prototype.updatedType=function(){var e=parseInt(this.$.find(i).val(),10);-1===e?this.$.find(".hideIfNoRecurrence").hide():(this.$.find(".hideIfNoRecurrence").show(),this.$.find("[data-recurrence-type]").hide(),this.$.find('[data-recurrence-type="'+e+'"]').show())},c.prototype.updatedEnd=function(){switch(parseInt(this.$.find("#recurrenceformmodel-end").val(),10)){case 0:return void r(".recurrence-end-date, .recurrence-end-occurrences").hide();case 1:return r(".recurrence-end-date").show(),void r(".recurrence-end-occurrences").hide();case 2:return r(".recurrence-end-date").hide(),void r(".recurrence-end-occurrences").show()}},t.export=c});