humhub.module("calendar.participants.List",function(n,t,i){const s=t("ui.widget").Widget,r=t("ui.loader"),a=t("client"),o=t("ui.status");t=s.extend();t.prototype.update=function(t){const e=t.$trigger.parent(),i=t.$trigger.parent().html(),s={entryId:this.data("entry-id"),userId:t.$trigger.closest("li").data("user-id"),status:t.$trigger.val()};r.set(e,{size:"10px",css:{padding:"0px"}}),a.post(this.data("update-url"),{data:s}).then(function(t){t.success&&(o.success(t.message),r.remove(e),e.html(i).find("select").val(s.status))}).catch(function(t){n.log.error(t,!0)}).finally(function(){t.finish()})},t.prototype.remove=function(t){const e=t.$trigger.closest("li");var i={entryId:this.data("entry-id"),userId:e.data("user-id")};a.post(this.data("remove-url"),{data:i}).then(function(t){t.success?(o.success(t.message),1===e.closest("ul").find("li[data-user-id]").length&&e.closest("ul").prev("p").show(),e.remove()):o.error(t.message)}).catch(function(t){n.log.error(t,!0)}).finally(function(){t.finish()})},t.prototype.displayAddForm=function(e){const i=this.$.find("ul.media-list");a.get(e).then(function(t){i.append(t.html),s.closest(i.find("[data-ui-init]")),e.$trigger.remove()}).catch(function(t){n.log.error(t,!0)}).finally(function(){e.finish()})},t.prototype.add=function(t){const e=t.$trigger.closest("li");var i={entryId:this.data("entry-id"),status:e.find("select[name=status]").val(),guids:e.find('select[name="newParticipants[]"]').val()};a.post(this.data("add-url"),{data:i}).then(function(t){t.success?(o.success(t.success),e.before(t.html).closest("ul").prev("p").hide()):t.warning?o.warn(t.warning):t.error&&o.error(t.error)}).catch(function(t){n.log.error(t,!0)}).finally(function(){t.finish()})},t.prototype.filterState=function(t){var e={id:this.data("entry-id"),state:t.$trigger.val()};r.set(t.$trigger.parent(),{size:"10px",css:{padding:"0px"}}),a.get(this.data("filter-url"),{data:e}).then(function(t){i("#globalModal").html(t.html)}).catch(function(t){n.log.error(t,!0)}).finally(function(){t.finish()})},n.export=t});