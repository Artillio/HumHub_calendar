humhub.module("calendar.participants.List",function(s,t,i){const n=t("ui.widget").Widget,r=t("ui.loader"),a=t("client"),o=t("ui.status");t=n.extend();t.prototype.update=function(t){const e=t.$trigger.parent(),i=t.$trigger.parent().html(),n={entryId:this.data("entry-id"),userId:t.$trigger.closest("li").data("user-id"),status:t.$trigger.val()};r.set(e,{size:"10px",css:{padding:"0px"}}),a.post(this.data("update-url"),{data:n}).then(function(t){t.success&&(o.success(t.message),r.remove(e),e.html(i).find("select").val(n.status))}).catch(function(t){s.log.error(t,!0)}).finally(function(){t.finish()})},t.prototype.remove=function(t){const e=t.$trigger.closest("li");var i={entryId:this.data("entry-id"),userId:e.data("user-id")};a.post(this.data("remove-url"),{data:i}).then(function(t){t.success?(o.success(t.message),1===e.closest("ul").find("li[data-user-id]").length&&e.closest("ul").prev("p").show(),e.remove()):o.error(t.message)}).catch(function(t){s.log.error(t,!0)}).finally(function(){t.finish()})},t.prototype.displayForm=function(e){const i=this.$.find("ul.media-list");a.get(e).then(function(t){i.append(t.html),n.closest(i.find("li.calendar-entry-new-participants-form:last-child").find("[data-ui-init]")),e.$trigger.remove()}).catch(function(t){s.log.error(t,!0)}).finally(function(){e.finish()})},t.prototype.add=function(t){const e=t.$trigger.closest("li"),i={entryId:this.data("entry-id"),guids:e.find('select[name="newParticipants[]"]').val()},n=e.find("select[name=status]");n.length&&(i.status=n.val()),a.post(t,{data:i}).then(function(t){t.success?(o.success(t.success),e.closest("ul").find("li.calendar-entry-new-participants-form:first").before(t.html).closest("ul").prev("p").hide()):t.warning?o.warn(t.warning):t.error&&o.error(t.error)}).catch(function(t){s.log.error(t,!0)}).finally(function(){t.finish()})},t.prototype.filterState=function(t){var e={id:this.data("entry-id"),state:t.$trigger.val()};r.set(t.$trigger.parent(),{size:"10px",css:{padding:"0px"}}),a.get(this.data("filter-url"),{data:e}).then(function(t){i("#globalModal").html(t.html)}).catch(function(t){s.log.error(t,!0)}).finally(function(){t.finish()})},s.export=t});